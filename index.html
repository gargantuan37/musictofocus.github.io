<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music</title>
    <link rel="stylesheet" href="style.css">
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
</head>

<body>
    <div class="app-container">
        <!-- Quadrant 1: Table 1 -->
        <div id="table1-container" class="quadrant table-quadrant">
            <div class="poker-table" id="table1">
                <!-- Player slots will be generated by JS -->
            </div>
            <div id="runtime-cropped-output-table1" class="runtime-cropped-output" style="display:none;">
                <h4 data-lang="debug_cropped_title_table1">Ảnh đã Paste (Bàn 1):</h4>
                <div id="runtime-crop-display-table1" class="runtime-crop-display-grid"></div>
                <button id="reprocess-ocr-btn-table1" class="reprocess-ocr-btn" style="display:none;"
                    data-lang="reprocess_ocr_btn">Xử lý OCR Bàn 1</button>
            </div>
        </div>

        <!-- Quadrant 2: Table 2 -->
        <div id="table2-container" class="quadrant table-quadrant">
            <div class="poker-table" id="table2">
                <!-- Player slots will be generated by JS -->
            </div>
            <div id="runtime-cropped-output-table2" class="runtime-cropped-output" style="display:none;">
                <h4 data-lang="debug_cropped_title_table2">Ảnh đã Paste (Bàn 2):</h4>
                <div id="runtime-crop-display-table2" class="runtime-crop-display-grid"></div>
                <button id="reprocess-ocr-btn-table2" class="reprocess-ocr-btn" style="display:none;"
                    data-lang="reprocess_ocr_btn">Xử lý OCR Bàn 2</button>
            </div>
        </div>

        <!-- Quadrant 3: Table 3 -->
        <div id="table3-container" class="quadrant table-quadrant">
            <div class="poker-table" id="table3">
                <!-- Player slots will be generated by JS -->
            </div>
            <div id="runtime-cropped-output-table3" class="runtime-cropped-output" style="display:none;">
                <h4 data-lang="debug_cropped_title_table3">Ảnh đã Paste (Bàn 3):</h4>
                <div id="runtime-crop-display-table3" class="runtime-crop-display-grid"></div>
                <button id="reprocess-ocr-btn-table3" class="reprocess-ocr-btn" style="display:none;"
                    data-lang="reprocess_ocr_btn">Xử lý OCR Bàn 3</button>
            </div>
        </div>

        <!-- Quadrant 4: Player Info & Actions -->
        <div id="player-info-actions-container" class="quadrant info-quadrant">
            <div class="player-details-section">
                <div class="notes-grid">
                    <label for="note-chung" data-lang="note_general">Note chung:</label>
                    <textarea id="note-chung" rows="3"></textarea>
                    <label for="note-pf" data-lang="note_pf">PF note:</label>
                    <textarea id="note-pf" rows="2"></textarea>
                    <label for="note-flop" data-lang="note_flop">Flop note:</label>
                    <textarea id="note-flop" rows="2"></textarea>
                    <label for="note-turn" data-lang="note_turn">Turn note:</label>
                    <textarea id="note-turn" rows="2"></textarea>
                    <label for="note-river" data-lang="note_river">River note:</label>
                    <textarea id="note-river" rows="2"></textarea>
                    <label for="note-bp" data-lang="note_bp">BP note:</label>
                    <textarea id="note-bp" rows="2"></textarea>
                </div>
            </div>

            <div class="actions-section">
                <div class="actions-controls-row">
                    <div class="color-dropdown-container">
                        <select id="color-select" class="color-select-dropdown"></select>
                    </div>
                    <button id="add-name-btn" data-lang="add_name_btn">Add Name</button>
                    <button id="setup-crop-regions-btn" data-lang="setup_crop_btn">Setup Vùng Cắt Ảnh</button>
                </div>
                <p id="status-message" class="status-message"></p>
            </div>
        </div>
    </div>

    <!-- Template cho một slot người chơi -->
    <template id="player-slot-template">
        <div class="player-slot" tabindex="0">
            <div class="player-name-wrapper">
                <input type="text" class="player-name-input" placeholder="Player Name">
                <div class="search-results-dropdown" style="display: none;"></div>
            </div>
            <div class="player-stats-inputs">
                <input type="text" class="stat-input vpip-input" placeholder="VPIP">
                <input type="text" class="stat-input pfr-input" placeholder="PFR">
                <input type="text" class="stat-input hands-input" placeholder="Hands">
            </div>
        </div>
    </template>

    <!-- Modal để Setup Vùng Cắt -->
    <div id="crop-setup-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-modal-btn">×</span>
            <h2 data-lang="crop_modal_title">Thiết lập Vùng Cắt Ảnh</h2>
            <p data-lang="crop_modal_instruction">Tải lên ảnh mẫu và vẽ 7 hình chữ nhật theo thứ tự bạn muốn trích xuất
                text. Các vùng sẽ được đánh số khi vẽ.</p>
            <div>
                <label for="setup-image-upload" data-lang="crop_modal_upload_label">Tải ảnh mẫu:</label>
                <input type="file" id="setup-image-upload" accept="image/*">
            </div>
            <div class="setup-canvas-container">
                <canvas id="setup-canvas"></canvas>
            </div>
            <div class="crop-previews-container">
                <h4 data-lang="crop_modal_preview_title">Xem trước các vùng cắt (Mục tiêu: 7 vùng):</h4>
                <div id="crop-previews" class="crop-previews"></div>
            </div>
            <div class="modal-actions">
                <button id="reset-regions-btn" data-lang="crop_modal_reset_btn">Vẽ Lại</button>
                <button id="accept-crop-regions-btn" disabled data-lang="crop_modal_accept_btn">Chấp Nhận & Lưu</button>
            </div>
            <p id="setup-status-message" class="status-message"></p>
        </div>
    </div>

    <script src="lib/fuse.min.js"></script>
    <script src="script.js"></script>
</body>

</html>